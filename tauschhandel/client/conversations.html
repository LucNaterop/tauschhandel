<template name="conversations">
	{{#contentFor "headerTitle"}}
		<h1 class="title">Chats</h1>
	{{/contentFor}}
	{{#contentFor "headerButtonRight"}}
		<a href="/profile" class="button button-clear pull-right" >
			Profil
		</a>
	{{/contentFor}}
	{{#ionView}}
		{{#ionContent}}
			{{#if Template.subscriptionsReady}}
				{{#ionList}}
					{{#if moreThanZero}}
						{{#each konversationen}}
							{{> conversationListItem}}
						{{/each}}
					{{else}}
						{{> nothingHere}}
					{{/if}}
				{{/ionList}}
			{{else}}
				{{> loader}}
			{{/if}}
		{{/ionContent}}
	{{/ionView}}
</template>

<template name="conversationListItem">
	{{#ionItem path="conversation" avatar=true iconRight=true class="item-icon-right conversation" }}
	 	<img src="{{other.profile.picture}}" height="50">
		<h2>{{other.username}}</h2> 
		<p>Übergabe von {{post.title}}</p>
		{{#if moreThanZero}}
			<span class="badge badge-assertive">{{badgeCount}}</span>
		{{else}}
			{{> ionIcon icon="ios-arrow-forward" class="positive"}}
		{{/if}}
	{{/ionItem}}
</template>

<template name="conversation">
	{{#contentFor "headerButtonLeft"}}
		{{>ionNavBackButton path="conversations" text="Chats"}}
	{{/contentFor}}
	{{#ionView}}
		{{#ionContent}}
			<div class="list">
				{{#each conversation.messages}}
					{{#if fromMe}}
						<div class="item item-text-wrap" style="background-color: #158ffe; border-radius: 5px; margin: 10px 10px 10px {{margin}}%">
							<p style="color: white; font-size: 17px">{{{message}}}</p>
						</div>
					{{else}}
						<div class="item item-text-wrap " style="background-color: #EEE; border-radius: 5px; margin: 10px {{margin}}% 10px 10px">
							<p style="font-size: 17px">{{{message}}}</p>
						</div>
					{{/if}}
				{{/each}}


				<div class="item item-input-inset">
					<label class="item-input-wrapper">
						<textarea id="message" type="text" placeholder="Type.." rows="4" style="background-color: #EEE"></textarea>
					</label>
					<button id="writeMessageButton" class="button button-small">
						Send
					</button>
				</div>
			</div>
		{{/ionContent}}

	{{/ionView}}
</template>

<template name="nothingHere">
	<div class="card padding">
		<p>Im Moment befindet sich hier noch nichts. Chats werden automatisch eröffnet, sobald du jemandem ein Item vergibst, oder dir jemand ein Item gibt. Anhand des Chats kannst du mit der anderen Person die Übergabe des Items besprechen. </p>
	</div>
</template>
